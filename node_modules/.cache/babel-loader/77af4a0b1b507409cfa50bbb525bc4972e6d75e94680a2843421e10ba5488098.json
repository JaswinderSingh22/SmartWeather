{"ast":null,"code":"import { ref, watchEffect } from 'vue';\nimport { useStore } from 'vuex';\nexport default {\n  name: 'SearchBar',\n  setup() {\n    const searchQuery = ref('');\n    const results = ref([]);\n    const store = useStore();\n    const fetchResults = async () => {\n      if (searchQuery.value.trim() === '') {\n        results.value = [];\n        return;\n      }\n      const apiKey = 'AIzaSyCOauRVg5VwBP52O13dnJS6lWn1_xineK8';\n      const apiUrl = `https://maps.googleapis.com/maps/api/geocode/json?address=${searchQuery.value}&key=${apiKey}`;\n      try {\n        const response = await fetch(apiUrl);\n        const data = await response.json();\n        console.log(\"response:\", data);\n        if (data.status === 'OK') {\n          results.value = data.results.map(result => {\n            return {\n              id: result.place_id,\n              name: result.address_components[0].long_name,\n              country: result.address_components.find(component => component.types.includes('country')).long_name,\n              latitude: result.geometry.location.lat,\n              longitude: result.geometry.location.lng\n            };\n          });\n        } else {\n          results.value = [];\n        }\n      } catch (error) {\n        console.error('Error fetching search results:', error);\n        results.value = [];\n      }\n    };\n    const selectResult = result => {\n      store.commit('selectCity', result);\n      results.value = [];\n    };\n\n    // Close dropdown when clicking outside\n    watchEffect(() => {\n      const closeDropdown = event => {\n        if (!event.target.closest('.relative')) {\n          results.value = [];\n        }\n      };\n      document.addEventListener('click', closeDropdown);\n      return () => {\n        document.removeEventListener('click', closeDropdown);\n      };\n    });\n    return {\n      searchQuery,\n      results,\n      fetchResults,\n      selectResult\n    };\n  }\n};","map":{"version":3,"names":["ref","watchEffect","useStore","name","setup","searchQuery","results","store","fetchResults","value","trim","apiKey","apiUrl","response","fetch","data","json","console","log","status","map","result","id","place_id","address_components","long_name","country","find","component","types","includes","latitude","geometry","location","lat","longitude","lng","error","selectResult","commit","closeDropdown","event","target","closest","document","addEventListener","removeEventListener"],"sources":["/Users/turbanator/Documents/CODING/FRONT-END/weather-app/src/components/SearchBar.vue"],"sourcesContent":["<template>\n    <div class=\"flex justify-center\">\n      <div class=\"relative w-6/12\">\n      <input v-model=\"searchQuery\" @input=\"fetchResults\" placeholder=\"Enter city or country\"\n             class=\"py-2 px-4 border border-gray-200 rounded-lg  min-w-fit\">\n             </div>\n      <ul v-if=\"results.length\"\n          class=\"absolute z-10 mt-10 w-6/12 bg-grey rounded-md shadow-lg overflow-hidden\">\n        <li v-for=\"result in results\" :key=\"result.id\" @click=\"selectResult(result)\"\n            class=\"py-2 cursor-pointer hover:bg-blue-100\">{{ result.name }}, {{ result.country }}</li>\n      </ul>\n    </div>\n  </template>\n  \n  <script>\n  import { ref , watchEffect} from 'vue';\n  import { useStore } from 'vuex';\n  \n  export default {\n    name: 'SearchBar',\n    setup() {\n      const searchQuery = ref('');\n      const results = ref([]);\n      const store = useStore();\n  \n      const fetchResults = async () => {\n      if (searchQuery.value.trim() === '') {\n        results.value = [];\n        return;\n      }\n      const apiKey = 'AIzaSyCOauRVg5VwBP52O13dnJS6lWn1_xineK8';\n      const apiUrl = `https://maps.googleapis.com/maps/api/geocode/json?address=${searchQuery.value}&key=${apiKey}`;\n\n      try {\n        const response = await fetch(apiUrl);\n        const data = await response.json();\n        console.log(\"response:\", data);\n        if (data.status === 'OK') {\n          results.value = data.results.map((result) => {\n            return {\n              id: result.place_id,\n              name: result.address_components[0].long_name,\n              country: result.address_components.find(\n                (component) => component.types.includes('country')\n                  ).long_name,\n              latitude: result.geometry.location.lat,\n              longitude: result.geometry.location.lng,\n            };\n          });\n        } else {\n          results.value = [];\n        }\n      }\n      catch (error) {\n        console.error('Error fetching search results:', error);\n        results.value = [];\n      }\n    };\n  \n    const selectResult = (result) => {\n      store.commit('selectCity', result);\n      results.value = [];\n    };\n\n  // Close dropdown when clicking outside\n    watchEffect(() => {\n      const closeDropdown = (event) => {\n        if (!event.target.closest('.relative')) {\n          results.value = [];\n        }\n      };\n\n      document.addEventListener('click', closeDropdown);\n\n      return () => {\n        document.removeEventListener('click', closeDropdown);\n      };\n    });\n    return { searchQuery, results, fetchResults, selectResult };\n  },\n  };\n  </script>\n  "],"mappings":"AAeE,SAASA,GAAE,EAAIC,WAAW,QAAO,KAAK;AACtC,SAASC,QAAO,QAAS,MAAM;AAE/B,eAAe;EACbC,IAAI,EAAE,WAAW;EACjBC,KAAKA,CAAA,EAAG;IACN,MAAMC,WAAU,GAAIL,GAAG,CAAC,EAAE,CAAC;IAC3B,MAAMM,OAAM,GAAIN,GAAG,CAAC,EAAE,CAAC;IACvB,MAAMO,KAAI,GAAIL,QAAQ,CAAC,CAAC;IAExB,MAAMM,YAAW,GAAI,MAAAA,CAAA,KAAY;MACjC,IAAIH,WAAW,CAACI,KAAK,CAACC,IAAI,CAAC,MAAM,EAAE,EAAE;QACnCJ,OAAO,CAACG,KAAI,GAAI,EAAE;QAClB;MACF;MACA,MAAME,MAAK,GAAI,yCAAyC;MACxD,MAAMC,MAAK,GAAK,6DAA4DP,WAAW,CAACI,KAAM,QAAOE,MAAO,EAAC;MAE7G,IAAI;QACF,MAAME,QAAO,GAAI,MAAMC,KAAK,CAACF,MAAM,CAAC;QACpC,MAAMG,IAAG,GAAI,MAAMF,QAAQ,CAACG,IAAI,CAAC,CAAC;QAClCC,OAAO,CAACC,GAAG,CAAC,WAAW,EAAEH,IAAI,CAAC;QAC9B,IAAIA,IAAI,CAACI,MAAK,KAAM,IAAI,EAAE;UACxBb,OAAO,CAACG,KAAI,GAAIM,IAAI,CAACT,OAAO,CAACc,GAAG,CAAEC,MAAM,IAAK;YAC3C,OAAO;cACLC,EAAE,EAAED,MAAM,CAACE,QAAQ;cACnBpB,IAAI,EAAEkB,MAAM,CAACG,kBAAkB,CAAC,CAAC,CAAC,CAACC,SAAS;cAC5CC,OAAO,EAAEL,MAAM,CAACG,kBAAkB,CAACG,IAAI,CACpCC,SAAS,IAAKA,SAAS,CAACC,KAAK,CAACC,QAAQ,CAAC,SAAS,CAC/C,CAAC,CAACL,SAAS;cACfM,QAAQ,EAAEV,MAAM,CAACW,QAAQ,CAACC,QAAQ,CAACC,GAAG;cACtCC,SAAS,EAAEd,MAAM,CAACW,QAAQ,CAACC,QAAQ,CAACG;YACtC,CAAC;UACH,CAAC,CAAC;QACJ,OAAO;UACL9B,OAAO,CAACG,KAAI,GAAI,EAAE;QACpB;MACF,EACA,OAAO4B,KAAK,EAAE;QACZpB,OAAO,CAACoB,KAAK,CAAC,gCAAgC,EAAEA,KAAK,CAAC;QACtD/B,OAAO,CAACG,KAAI,GAAI,EAAE;MACpB;IACF,CAAC;IAED,MAAM6B,YAAW,GAAKjB,MAAM,IAAK;MAC/Bd,KAAK,CAACgC,MAAM,CAAC,YAAY,EAAElB,MAAM,CAAC;MAClCf,OAAO,CAACG,KAAI,GAAI,EAAE;IACpB,CAAC;;IAEH;IACER,WAAW,CAAC,MAAM;MAChB,MAAMuC,aAAY,GAAKC,KAAK,IAAK;QAC/B,IAAI,CAACA,KAAK,CAACC,MAAM,CAACC,OAAO,CAAC,WAAW,CAAC,EAAE;UACtCrC,OAAO,CAACG,KAAI,GAAI,EAAE;QACpB;MACF,CAAC;MAEDmC,QAAQ,CAACC,gBAAgB,CAAC,OAAO,EAAEL,aAAa,CAAC;MAEjD,OAAO,MAAM;QACXI,QAAQ,CAACE,mBAAmB,CAAC,OAAO,EAAEN,aAAa,CAAC;MACtD,CAAC;IACH,CAAC,CAAC;IACF,OAAO;MAAEnC,WAAW;MAAEC,OAAO;MAAEE,YAAY;MAAE8B;IAAa,CAAC;EAC7D;AACA,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}